<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameShop - B√°n T√†i Kho·∫£n Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .cart-badge {
            animation: bounce 0.3s ease-in-out;
        }
        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        .slide-in {
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .pulse {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .loading-dots::after {
            content: '';
            animation: dots 1.5s infinite;
        }
        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }
        .hover-glow:hover {
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
        }
        .notification {
            animation: slideInRight 0.3s ease-out;
        }
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .notification.hide {
            animation: slideOutRight 0.3s ease-in forwards;
        }
        @keyframes slideOutRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        .telegram-float {
            animation: telegramFloat 3s ease-in-out infinite;
        }
        @keyframes telegramFloat {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-10px) rotate(2deg); }
            50% { transform: translateY(-5px) rotate(0deg); }
            75% { transform: translateY(-15px) rotate(-2deg); }
        }
        .telegram-pulse {
            animation: telegramPulse 2s infinite;
        }
        @keyframes telegramPulse {
            0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
            100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 min-h-screen">
    <!-- Header -->
    <header class="bg-black/20 backdrop-blur-md border-b border-white/10 sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <h1 class="text-2xl font-bold text-white">üéÆ GameShop</h1>
                    <nav class="hidden md:flex space-x-6" id="main-nav" style="display: none;">
                        <a href="#" onclick="showPage('home')" class="text-white/80 hover:text-white transition">Trang ch·ªß</a>
                        <a href="#" onclick="showPage('products')" class="text-white/80 hover:text-white transition">S·∫£n ph·∫©m</a>
                        <a href="#" onclick="showPage('orders')" class="text-white/80 hover:text-white transition">ƒê∆°n h√†ng</a>
                        <a href="#" onclick="showPage('profile')" class="text-white/80 hover:text-white transition">H·ªì s∆°</a>
                        <a href="#" onclick="showPage('admin')" id="admin-nav" class="text-white/80 hover:text-white transition hidden">Qu·∫£n tr·ªã</a>
                    </nav>
                </div>
                <div class="flex items-center space-x-4">
                    <button onclick="showPage('cart')" id="cart-btn" class="relative text-white hover:text-yellow-400 transition" style="display: none;">
                        üõí <span id="cart-count" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">0</span>
                    </button>
                    <div id="user-menu" class="flex items-center space-x-2">
                        <button onclick="showPage('login')" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg text-white transition">ƒêƒÉng nh·∫≠p</button>
                        <button onclick="showPage('register')" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg text-white transition">ƒêƒÉng k√Ω</button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Login Required Page -->
        <div id="login-required-page" class="page fade-in">
            <div class="text-center mb-12">
                <div class="text-8xl mb-6">üîí</div>
                <h2 class="text-4xl font-bold text-white mb-4">Vui l√≤ng ƒëƒÉng nh·∫≠p</h2>
                <p class="text-xl text-white/80 mb-8">B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ truy c·∫≠p GameShop</p>
                <div class="space-x-4">
                    <button onclick="showPage('login')" class="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 px-8 py-3 rounded-lg text-white font-semibold transition transform hover:scale-105">
                        ƒêƒÉng nh·∫≠p
                    </button>
                    <button onclick="showPage('register')" class="bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 px-8 py-3 rounded-lg text-white font-semibold transition transform hover:scale-105">
                        ƒêƒÉng k√Ω
                    </button>
                </div>
            </div>
        </div>

        <!-- Home Page -->
        <div id="home-page" class="page hidden">
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h2 class="text-3xl font-bold text-white">Ch√†o m·ª´ng ƒë·∫øn GameShop</h2>
                    <p class="text-white/80">S·ªë d∆∞: <span id="user-balance" class="text-yellow-400 font-semibold">0ƒë</span></p>
                </div>
                <button onclick="requestRecharge()" class="bg-green-600 hover:bg-green-700 px-6 py-2 rounded-lg text-white font-semibold transition">
                    üí∞ N·∫°p ti·ªÅn
                </button>
            </div>
            
            <div class="grid md:grid-cols-3 gap-8 mb-12">
                <div class="bg-white/10 backdrop-blur-md rounded-xl p-6 text-center">
                    <div class="text-4xl mb-4">‚ö°</div>
                    <h3 class="text-xl font-semibold text-white mb-2">Giao h√†ng nhanh</h3>
                    <p class="text-white/70">Nh·∫≠n t√†i kho·∫£n ngay sau khi thanh to√°n</p>
                </div>
                <div class="bg-white/10 backdrop-blur-md rounded-xl p-6 text-center">
                    <div class="text-4xl mb-4">üõ°Ô∏è</div>
                    <h3 class="text-xl font-semibold text-white mb-2">B·∫£o m·∫≠t cao</h3>
                    <p class="text-white/70">T√†i kho·∫£n ƒë∆∞·ª£c ki·ªÉm tra k·ªπ l∆∞·ª°ng</p>
                </div>
                <div class="bg-white/10 backdrop-blur-md rounded-xl p-6 text-center">
                    <div class="text-4xl mb-4">üíé</div>
                    <h3 class="text-xl font-semibold text-white mb-2">Ch·∫•t l∆∞·ª£ng</h3>
                    <p class="text-white/70">Ch·ªâ b√°n t√†i kho·∫£n ch·∫•t l∆∞·ª£ng cao</p>
                </div>
            </div>

            <div class="bg-white/10 backdrop-blur-md rounded-xl p-8">
                <h3 class="text-2xl font-bold text-white mb-6 text-center">S·∫£n ph·∫©m n·ªïi b·∫≠t</h3>
                <div class="grid md:grid-cols-4 gap-6" id="featured-products">
                    <!-- Featured products will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Products Page -->
        <div id="products-page" class="page hidden">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-3xl font-bold text-white">Danh s√°ch s·∫£n ph·∫©m</h2>
                <div class="flex space-x-4">
                    <select id="game-filter" class="bg-white/10 backdrop-blur-md text-white rounded-lg px-4 py-2 border border-white/20">
                        <option value="">T·∫•t c·∫£ game</option>
                        <option value="Li√™n Qu√¢n Mobile">Li√™n Qu√¢n Mobile</option>
                        <option value="PUBG Mobile">PUBG Mobile</option>
                        <option value="Free Fire">Free Fire</option>
                        <option value="Mobile Legends">Mobile Legends</option>
                    </select>
                    <select id="price-filter" class="bg-white/10 backdrop-blur-md text-white rounded-lg px-4 py-2 border border-white/20">
                        <option value="">T·∫•t c·∫£ gi√°</option>
                        <option value="0-100000">D∆∞·ªõi 100k</option>
                        <option value="100000-500000">100k - 500k</option>
                        <option value="500000-1000000">500k - 1M</option>
                        <option value="1000000-999999999">Tr√™n 1M</option>
                    </select>
                </div>
            </div>
            <div class="grid md:grid-cols-4 gap-6" id="products-grid">
                <!-- Products will be loaded here -->
            </div>
        </div>

        <!-- Product Detail Page -->
        <div id="product-detail-page" class="page hidden">
            <div id="product-detail-content">
                <!-- Product detail will be loaded here -->
            </div>
        </div>

        <!-- Cart Page -->
        <div id="cart-page" class="page hidden">
            <h2 class="text-3xl font-bold text-white mb-8">Gi·ªè h√†ng</h2>
            <div class="bg-white/10 backdrop-blur-md rounded-xl p-6">
                <div id="cart-items">
                    <!-- Cart items will be loaded here -->
                </div>
                <div class="border-t border-white/20 pt-6 mt-6">
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-xl font-semibold text-white">T·ªïng c·ªông:</span>
                        <span id="cart-total" class="text-2xl font-bold text-yellow-400">0ƒë</span>
                    </div>
                    <button onclick="showPage('checkout')" class="w-full bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 px-6 py-3 rounded-lg text-white font-semibold transition">
                        Thanh to√°n
                    </button>
                </div>
            </div>
        </div>

        <!-- Checkout Page -->
        <div id="checkout-page" class="page hidden">
            <h2 class="text-3xl font-bold text-white mb-8">Thanh to√°n</h2>
            <div class="grid md:grid-cols-2 gap-8">
                <div class="bg-white/10 backdrop-blur-md rounded-xl p-6">
                    <h3 class="text-xl font-semibold text-white mb-4">Th√¥ng tin ƒë∆°n h√†ng</h3>
                    <div id="checkout-items">
                        <!-- Checkout items will be loaded here -->
                    </div>
                    <div class="border-t border-white/20 pt-4 mt-4">
                        <div class="flex justify-between text-white">
                            <span class="font-semibold">T·ªïng c·ªông:</span>
                            <span id="checkout-total" class="font-bold text-yellow-400">0ƒë</span>
                        </div>
                    </div>
                </div>
                <div class="bg-white/10 backdrop-blur-md rounded-xl p-6">
                    <h3 class="text-xl font-semibold text-white mb-4">Thanh to√°n b·∫±ng s·ªë d∆∞</h3>
                    <div class="mb-4">
                        <p class="text-white/80">S·ªë d∆∞ hi·ªán t·∫°i: <span id="checkout-balance" class="text-yellow-400 font-semibold">0ƒë</span></p>
                    </div>
                    <form id="checkout-form" class="space-y-4">
                        <button type="submit" class="w-full bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 px-6 py-3 rounded-lg text-white font-semibold transition">
                            Thanh to√°n
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Orders Page -->
        <div id="orders-page" class="page hidden">
            <h2 class="text-3xl font-bold text-white mb-8">L·ªãch s·ª≠ ƒë∆°n h√†ng</h2>
            <div class="space-y-6" id="orders-list">
                <!-- Orders will be loaded here -->
            </div>
        </div>

        <!-- Profile Page -->
        <div id="profile-page" class="page hidden">
            <div class="grid md:grid-cols-3 gap-8">
                <!-- User Info -->
                <div class="bg-white/10 backdrop-blur-md rounded-xl p-6">
                    <div class="text-center mb-6">
                        <div class="text-6xl mb-4">üë§</div>
                        <h3 class="text-xl font-semibold text-white" id="profile-name">T√™n ng∆∞·ªùi d√πng</h3>
                        <p class="text-white/70" id="profile-email">email@example.com</p>
                    </div>
                    <div class="space-y-4">
                        <div class="bg-white/10 rounded-lg p-4">
                            <div class="text-white/60 text-sm">S·ªë d∆∞ t√†i kho·∫£n</div>
                            <div class="text-yellow-400 font-bold text-xl" id="profile-balance">0ƒë</div>
                        </div>
                        <div class="bg-white/10 rounded-lg p-4">
                            <div class="text-white/60 text-sm">T·ªïng ƒë√£ chi ti√™u</div>
                            <div class="text-white font-semibold" id="profile-spent">0ƒë</div>
                        </div>
                        <div class="bg-white/10 rounded-lg p-4">
                            <div class="text-white/60 text-sm">S·ªë ƒë∆°n h√†ng</div>
                            <div class="text-white font-semibold" id="profile-orders">0</div>
                        </div>
                        <button onclick="requestRecharge()" class="w-full bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg text-white font-semibold transition">
                            üí∞ N·∫°p ti·ªÅn
                        </button>
                    </div>
                </div>

                <!-- Purchase History -->
                <div class="md:col-span-2 bg-white/10 backdrop-blur-md rounded-xl p-6">
                    <h3 class="text-xl font-semibold text-white mb-6">L·ªãch s·ª≠ mua h√†ng</h3>
                    <div class="space-y-4" id="profile-purchase-history">
                        <!-- Purchase history will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Login Page -->
        <div id="login-page" class="page hidden">
            <div class="max-w-md mx-auto bg-white/10 backdrop-blur-md rounded-xl p-8">
                <h2 class="text-2xl font-bold text-white mb-6 text-center">ƒêƒÉng nh·∫≠p</h2>
                <form id="login-form" class="space-y-4">
                    <div>
                        <label class="block text-white mb-2">Email</label>
                        <input type="email" required class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 text-white placeholder-white/50" placeholder="Nh·∫≠p email">
                    </div>
                    <div>
                        <label class="block text-white mb-2">M·∫≠t kh·∫©u</label>
                        <input type="password" required class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 text-white placeholder-white/50" placeholder="Nh·∫≠p m·∫≠t kh·∫©u">
                    </div>
                    <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded-lg text-white font-semibold transition">
                        ƒêƒÉng nh·∫≠p
                    </button>
                </form>
                <p class="text-center text-white/70 mt-4">
                    Ch∆∞a c√≥ t√†i kho·∫£n? <a href="#" onclick="showPage('register')" class="text-blue-400 hover:text-blue-300">ƒêƒÉng k√Ω ngay</a>
                </p>
            </div>
        </div>

        <!-- Register Page -->
        <div id="register-page" class="page hidden">
            <div class="max-w-md mx-auto bg-white/10 backdrop-blur-md rounded-xl p-8">
                <h2 class="text-2xl font-bold text-white mb-6 text-center">ƒêƒÉng k√Ω</h2>
                <form id="register-form" class="space-y-4">
                    <div>
                        <label class="block text-white mb-2">H·ªç t√™n</label>
                        <input type="text" required class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 text-white placeholder-white/50" placeholder="Nh·∫≠p h·ªç t√™n">
                    </div>
                    <div>
                        <label class="block text-white mb-2">Email</label>
                        <input type="email" required class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 text-white placeholder-white/50" placeholder="Nh·∫≠p email">
                    </div>
                    <div>
                        <label class="block text-white mb-2">S·ªë ƒëi·ªán tho·∫°i</label>
                        <input type="tel" required class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 text-white placeholder-white/50" placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i">
                    </div>
                    <div>
                        <label class="block text-white mb-2">M·∫≠t kh·∫©u</label>
                        <input type="password" required class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 text-white placeholder-white/50" placeholder="Nh·∫≠p m·∫≠t kh·∫©u">
                    </div>
                    <div>
                        <label class="block text-white mb-2">X√°c nh·∫≠n m·∫≠t kh·∫©u</label>
                        <input type="password" required class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 text-white placeholder-white/50" placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u">
                    </div>
                    <button type="submit" class="w-full bg-green-600 hover:bg-green-700 px-6 py-3 rounded-lg text-white font-semibold transition">
                        ƒêƒÉng k√Ω
                    </button>
                </form>
                <p class="text-center text-white/70 mt-4">
                    ƒê√£ c√≥ t√†i kho·∫£n? <a href="#" onclick="showPage('login')" class="text-blue-400 hover:text-blue-300">ƒêƒÉng nh·∫≠p</a>
                </p>
            </div>
        </div>

        <!-- Admin Panel -->
        <div id="admin-page" class="page hidden">
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h2 class="text-3xl font-bold text-white">B·∫£ng ƒëi·ªÅu khi·ªÉn Admin</h2>
                    <p class="text-white/70">Ch√†o m·ª´ng tr·ªü l·∫°i, Qu·∫£n tr·ªã vi√™n!</p>
                </div>
                <div class="flex space-x-3">
                    <button onclick="refreshAdminData()" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg text-white transition">
                        üîÑ L√†m m·ªõi
                    </button>
                    <button onclick="logout()" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded-lg text-white transition">
                        ƒêƒÉng xu·∫•t
                    </button>
                </div>
            </div>
            
            <!-- Stats Cards -->
            <div class="grid md:grid-cols-4 gap-6 mb-8">
                <div class="bg-gradient-to-r from-blue-600 to-blue-700 rounded-xl p-6 text-white transform hover:scale-105 transition">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-semibold mb-2">T·ªïng doanh thu</h3>
                            <p class="text-3xl font-bold" id="total-revenue">0ƒë</p>
                            <p class="text-sm opacity-80">Ch∆∞a c√≥ giao d·ªãch</p>
                        </div>
                        <div class="text-4xl opacity-80">üí∞</div>
                    </div>
                </div>
                <div class="bg-gradient-to-r from-green-600 to-green-700 rounded-xl p-6 text-white transform hover:scale-105 transition">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-semibold mb-2">ƒê∆°n h√†ng h√¥m nay</h3>
                            <p class="text-3xl font-bold" id="today-orders">0</p>
                            <p class="text-sm opacity-80">Ch∆∞a c√≥ ƒë∆°n h√†ng</p>
                        </div>
                        <div class="text-4xl opacity-80">üì¶</div>
                    </div>
                </div>
                <div class="bg-gradient-to-r from-purple-600 to-purple-700 rounded-xl p-6 text-white transform hover:scale-105 transition">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-semibold mb-2">T√†i kho·∫£n c√≤n l·∫°i</h3>
                            <p class="text-3xl font-bold" id="remaining-accounts">0</p>
                            <p class="text-sm opacity-80">Ch∆∞a c√≥ s·∫£n ph·∫©m</p>
                        </div>
                        <div class="text-4xl opacity-80">üéÆ</div>
                    </div>
                </div>
                <div class="bg-gradient-to-r from-orange-600 to-orange-700 rounded-xl p-6 text-white transform hover:scale-105 transition">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-semibold mb-2">Ng∆∞·ªùi d√πng</h3>
                            <p class="text-3xl font-bold" id="total-users">0</p>
                            <p class="text-sm opacity-80">Ch∆∞a c√≥ ng∆∞·ªùi d√πng</p>
                        </div>
                        <div class="text-4xl opacity-80">üë•</div>
                    </div>
                </div>
            </div>

            <!-- Admin Tabs -->
            <div class="bg-white/10 backdrop-blur-md rounded-xl p-6 mb-8">
                <div class="flex space-x-4 mb-6 border-b border-white/20">
                    <button onclick="showAdminTab('products')" class="admin-tab active px-4 py-2 text-white border-b-2 border-blue-500">
                        Qu·∫£n l√Ω s·∫£n ph·∫©m
                    </button>
                    <button onclick="showAdminTab('orders')" class="admin-tab px-4 py-2 text-white/70 hover:text-white border-b-2 border-transparent">
                        ƒê∆°n h√†ng
                    </button>
                    <button onclick="showAdminTab('users')" class="admin-tab px-4 py-2 text-white/70 hover:text-white border-b-2 border-transparent">
                        Ng∆∞·ªùi d√πng
                    </button>
                    <button onclick="showAdminTab('recharge')" class="admin-tab px-4 py-2 text-white/70 hover:text-white border-b-2 border-transparent">
                        N·∫°p ti·ªÅn
                    </button>
                </div>

                <!-- Products Tab -->
                <div id="admin-products" class="admin-tab-content">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-semibold text-white">Qu·∫£n l√Ω t√†i kho·∫£n game</h3>
                        <div class="space-x-3">
                            <button onclick="showAddProductModal()" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg text-white transition">
                                ‚ûï Th√™m t√†i kho·∫£n
                            </button>
                            <button onclick="importCSV()" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg text-white transition">
                                üìÅ Import CSV
                            </button>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-white">
                            <thead class="bg-white/10">
                                <tr>
                                    <th class="px-4 py-3 text-left">ID</th>
                                    <th class="px-4 py-3 text-left">T√™n s·∫£n ph·∫©m</th>
                                    <th class="px-4 py-3 text-left">Game</th>
                                    <th class="px-4 py-3 text-left">Gi√°</th>
                                    <th class="px-4 py-3 text-left">Tr·∫°ng th√°i</th>
                                    <th class="px-4 py-3 text-left">Thao t√°c</th>
                                </tr>
                            </thead>
                            <tbody id="admin-products-table">
                                <!-- Products will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Orders Tab -->
                <div id="admin-orders" class="admin-tab-content hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-semibold text-white">Qu·∫£n l√Ω ƒë∆°n h√†ng</h3>
                        <select class="bg-white/10 text-white rounded-lg px-4 py-2 border border-white/20">
                            <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
                            <option value="pending">Ch·ªù x·ª≠ l√Ω</option>
                            <option value="completed">Ho√†n th√†nh</option>
                            <option value="cancelled">ƒê√£ h·ªßy</option>
                        </select>
                    </div>
                    <div class="space-y-4" id="admin-orders-list">
                        <!-- Orders will be loaded here -->
                    </div>
                </div>

                <!-- Users Tab -->
                <div id="admin-users" class="admin-tab-content hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-semibold text-white">Qu·∫£n l√Ω ng∆∞·ªùi d√πng</h3>
                        <input type="text" placeholder="T√¨m ki·∫øm ng∆∞·ªùi d√πng..." class="bg-white/10 text-white rounded-lg px-4 py-2 border border-white/20 placeholder-white/50">
                    </div>
                    <div class="grid gap-4" id="admin-users-list">
                        <!-- Users will be loaded here -->
                    </div>
                </div>

                <!-- Recharge Tab -->
                <div id="admin-recharge" class="admin-tab-content hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-semibold text-white">Qu·∫£n l√Ω n·∫°p ti·ªÅn</h3>
                        <div class="text-white/70 text-sm">
                            X·ª≠ l√Ω y√™u c·∫ßu n·∫°p ti·ªÅn t·ª´ ng∆∞·ªùi d√πng
                        </div>
                    </div>
                    
                    <!-- Recharge Form -->
                    <div class="bg-white/10 rounded-xl p-6 mb-6">
                        <h4 class="text-lg font-semibold text-white mb-4">N·∫°p ti·ªÅn cho ng∆∞·ªùi d√πng</h4>
                        <form id="recharge-form" class="grid md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-white mb-2">Email ng∆∞·ªùi d√πng *</label>
                                <input type="email" id="recharge-email" required class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 text-white placeholder-white/50" placeholder="Nh·∫≠p email">
                            </div>
                            <div>
                                <label class="block text-white mb-2">S·ªë ti·ªÅn (VNƒê) *</label>
                                <input type="number" id="recharge-amount" required class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 text-white placeholder-white/50" placeholder="Nh·∫≠p s·ªë ti·ªÅn">
                            </div>
                            <div class="flex items-end">
                                <button type="submit" class="w-full bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg text-white font-semibold transition">
                                    N·∫°p ti·ªÅn
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Recharge Requests -->
                    <div class="bg-white/10 rounded-xl p-6">
                        <h4 class="text-lg font-semibold text-white mb-4">Y√™u c·∫ßu n·∫°p ti·ªÅn</h4>
                        <div class="space-y-4" id="recharge-requests">
                            <div class="text-center text-white/60 py-8">
                                Ch∆∞a c√≥ y√™u c·∫ßu n·∫°p ti·ªÅn n√†o
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Add/Edit Product Modal -->
    <div id="product-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="bg-white/10 backdrop-blur-md rounded-xl p-6 max-w-sm mx-4 w-full max-h-[90vh] overflow-y-auto">
            <h3 class="text-xl font-bold text-white mb-4" id="product-modal-title">Th√™m s·∫£n ph·∫©m m·ªõi</h3>
            <form id="product-form" class="space-y-3">
                <input type="hidden" id="product-id">
                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label class="block text-white text-sm mb-1">T√™n s·∫£n ph·∫©m *</label>
                        <input type="text" id="product-name" required class="w-full bg-white/10 border border-white/20 rounded px-3 py-2 text-white text-sm placeholder-white/50" placeholder="T√™n s·∫£n ph·∫©m">
                    </div>
                    <div>
                        <label class="block text-white text-sm mb-1">Game *</label>
                        <select id="product-game" required class="w-full bg-white/10 border border-white/20 rounded px-3 py-2 text-white text-sm">
                            <option value="">Ch·ªçn game</option>
                            <option value="Li√™n Qu√¢n Mobile">Li√™n Qu√¢n</option>
                            <option value="PUBG Mobile">PUBG</option>
                            <option value="Free Fire">Free Fire</option>
                            <option value="Mobile Legends">ML</option>
                        </select>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label class="block text-white text-sm mb-1">Gi√° (VNƒê) *</label>
                        <input type="number" id="product-price" required class="w-full bg-white/10 border border-white/20 rounded px-3 py-2 text-white text-sm placeholder-white/50" placeholder="Gi√°">
                    </div>
                    <div>
                        <label class="block text-white text-sm mb-1">Rank *</label>
                        <input type="text" id="product-rank" required class="w-full bg-white/10 border border-white/20 rounded px-3 py-2 text-white text-sm placeholder-white/50" placeholder="Rank">
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label class="block text-white text-sm mb-1">S·ªë skin *</label>
                        <input type="number" id="product-skins" required class="w-full bg-white/10 border border-white/20 rounded px-3 py-2 text-white text-sm placeholder-white/50" placeholder="S·ªë skin">
                    </div>
                    <div>
                        <label class="block text-white text-sm mb-1">Icon</label>
                        <select id="product-image" class="w-full bg-white/10 border border-white/20 rounded px-3 py-2 text-white text-sm">
                            <option value="üéÆ">üéÆ</option>
                            <option value="üî´">üî´</option>
                            <option value="üî•">üî•</option>
                            <option value="‚öîÔ∏è">‚öîÔ∏è</option>
                            <option value="üèÜ">üèÜ</option>
                            <option value="üíé">üíé</option>
                        </select>
                    </div>
                </div>
                <div>
                    <label class="block text-white text-sm mb-1">M√¥ t·∫£</label>
                    <textarea id="product-description" class="w-full bg-white/10 border border-white/20 rounded px-3 py-2 text-white text-sm placeholder-white/50" rows="2" placeholder="M√¥ t·∫£ ng·∫Øn"></textarea>
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label class="block text-white text-sm mb-1">T√†i kho·∫£n *</label>
                        <input type="text" id="product-username" required class="w-full bg-white/10 border border-white/20 rounded px-3 py-2 text-white text-sm placeholder-white/50" placeholder="Username">
                    </div>
                    <div>
                        <label class="block text-white text-sm mb-1">M·∫≠t kh·∫©u *</label>
                        <input type="text" id="product-password" required class="w-full bg-white/10 border border-white/20 rounded px-3 py-2 text-white text-sm placeholder-white/50" placeholder="Password">
                    </div>
                </div>
                <div class="flex space-x-2 pt-3">
                    <button type="submit" class="flex-1 bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded text-white text-sm font-semibold transition">
                        L∆∞u
                    </button>
                    <button type="button" onclick="closeProductModal()" class="flex-1 bg-gray-600 hover:bg-gray-700 px-4 py-2 rounded text-white text-sm font-semibold transition">
                        H·ªßy
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Recharge Request Modal -->
    <div id="recharge-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50 p-4">
        <div class="bg-white/10 backdrop-blur-md rounded-xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto">
            <h3 class="text-xl font-bold text-white mb-4">üí∞ N·∫°p ti·ªÅn v√†o t√†i kho·∫£n</h3>
            
            <!-- Bank Transfer Info -->
            <div class="bg-gradient-to-r from-blue-600/20 to-purple-600/20 border border-blue-500/30 rounded-xl p-4 mb-4">
                <h4 class="text-base font-semibold text-white mb-3 flex items-center">
                    üè¶ Th√¥ng tin chuy·ªÉn kho·∫£n
                </h4>
                <div class="space-y-2">
                    <div class="bg-white/10 rounded-lg p-2">
                        <div class="flex justify-between items-center">
                            <div class="flex-1 min-w-0">
                                <p class="text-white/70 text-xs">S·ªë t√†i kho·∫£n:</p>
                                <p class="text-white font-mono text-sm truncate">868686806456</p>
                            </div>
                            <button onclick="copyToClipboard('868686806456')" class="bg-blue-600 hover:bg-blue-700 px-2 py-1 rounded text-white text-xs transition ml-2 flex-shrink-0">
                                üìã
                            </button>
                        </div>
                    </div>
                    <div class="bg-white/10 rounded-lg p-2">
                        <p class="text-white/70 text-xs">Ng√¢n h√†ng:</p>
                        <p class="text-white font-semibold text-sm">MB Bank</p>
                    </div>
                    <div class="bg-white/10 rounded-lg p-2">
                        <p class="text-white/70 text-xs">Ch·ªß t√†i kho·∫£n:</p>
                        <p class="text-white font-semibold text-sm">NGUYEN HO GIA BAO</p>
                    </div>
                    <div class="bg-white/10 rounded-lg p-2">
                        <div class="flex justify-between items-center">
                            <div class="flex-1 min-w-0">
                                <p class="text-white/70 text-xs">N·ªôi dung chuy·ªÉn kho·∫£n:</p>
                                <p class="text-white font-mono text-sm truncate" id="transfer-content">${currentUser?.name || 'T√™n ƒëƒÉng nh·∫≠p'}</p>
                            </div>
                            <button onclick="copyToClipboard(document.getElementById('transfer-content').textContent)" class="bg-blue-600 hover:bg-blue-700 px-2 py-1 rounded text-white text-xs transition ml-2 flex-shrink-0">
                                üìã
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <form id="recharge-request-form" class="space-y-3">
                <div>
                    <label class="block text-white mb-1 text-sm">S·ªë ti·ªÅn mu·ªën n·∫°p (VNƒê) *</label>
                    <input type="number" required class="w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 text-sm" placeholder="Nh·∫≠p s·ªë ti·ªÅn">
                </div>
                <div>
                    <label class="block text-white mb-1 text-sm">Ghi ch√∫</label>
                    <textarea class="w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 text-sm" rows="2" placeholder="Ghi ch√∫ th√™m (t√πy ch·ªçn)"></textarea>
                </div>
                
                <!-- Important Notes -->
                <div class="bg-yellow-600/20 border border-yellow-500/30 rounded-lg p-3">
                    <h5 class="text-yellow-400 font-semibold mb-2 text-sm">üìù L∆∞u √Ω quan tr·ªçng:</h5>
                    <ul class="text-yellow-200 text-xs space-y-1">
                        <li>‚Ä¢ Giao d·ªãch s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω trong 3-4 ph√∫t</li>
                        <li>‚Ä¢ N·∫øu qu√° th·ªùi gian, vui l√≤ng inbox Telegram v√† g·ª≠i bill chuy·ªÉn kho·∫£n</li>
                        <li>‚Ä¢ Nh·∫≠p ƒë√∫ng n·ªôi dung chuy·ªÉn kho·∫£n ƒë·ªÉ x·ª≠ l√Ω nhanh ch√≥ng</li>
                    </ul>
                </div>
                
                <div class="flex space-x-2 pt-2">
                    <button type="submit" class="flex-1 bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg text-white font-semibold transition text-sm">
                        X√°c nh·∫≠n n·∫°p ti·ªÅn
                    </button>
                    <button type="button" onclick="closeRechargeModal()" class="flex-1 bg-gray-600 hover:bg-gray-700 px-4 py-2 rounded-lg text-white font-semibold transition text-sm">
                        H·ªßy
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Telegram Icon -->
    <div id="telegram-icon" class="fixed bottom-6 right-6 z-50" style="display: none;">
        <a href="https://t.me/dopinews" target="_blank" rel="noopener noreferrer" class="relative block bg-gradient-to-br from-blue-400 via-blue-500 to-blue-600 hover:from-blue-500 hover:via-blue-600 hover:to-blue-700 text-white p-4 rounded-full shadow-2xl transition-all duration-500 transform hover:scale-110 telegram-float telegram-pulse">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor" class="drop-shadow-lg">
                <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
            </svg>
            <!-- Notification badge -->
            <div class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center animate-pulse">
                !
            </div>
        </a>
    </div>

    <!-- Notification System -->
    <div id="notification-container" class="fixed top-4 right-4 z-50 space-y-2">
        <!-- Notifications will appear here -->
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="bg-white/10 backdrop-blur-md rounded-xl p-8 text-center">
            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"></div>
            <p class="text-white">ƒêang t·∫£i...</p>
        </div>
    </div>

    <script>
        // Sample data
        const products = [
            {
                id: 1,
                name: "T√†i kho·∫£n Li√™n Qu√¢n VIP",
                game: "Li√™n Qu√¢n Mobile",
                price: 250000,
                rank: "Cao Th·ªß",
                skins: 45,
                description: "T√†i kho·∫£n Li√™n Qu√¢n Mobile rank Cao Th·ªß v·ªõi 45 skin ƒë·∫πp, t∆∞·ªõng ƒë·∫ßy ƒë·ªß",
                image: "üéÆ",
                rating: 4.8,
                reviews: 124,
                username: "lienquan_vip001",
                password: "LQ2024@VIP",
                sold: false
            },
            {
                id: 2,
                name: "PUBG Mobile Conqueror",
                game: "PUBG Mobile",
                price: 450000,
                rank: "Conqueror",
                skins: 23,
                description: "T√†i kho·∫£n PUBG Mobile rank Conqueror, nhi·ªÅu skin s√∫ng v√† outfit hi·∫øm",
                image: "üî´",
                rating: 4.9,
                reviews: 89,
                username: "pubg_conqueror_pro",
                password: "PUBG2024#Pro",
                sold: false
            },
            {
                id: 3,
                name: "Free Fire Heroic",
                game: "Free Fire",
                price: 180000,
                rank: "Heroic",
                skins: 67,
                description: "T√†i kho·∫£n Free Fire rank Heroic v·ªõi collection skin ƒë·∫ßy ƒë·ªß",
                image: "üî•",
                rating: 4.7,
                reviews: 156,
                username: "freefire_heroic99",
                password: "FF2024$Hero",
                sold: false
            },
            {
                id: 4,
                name: "Mobile Legends Mythic",
                game: "Mobile Legends",
                price: 320000,
                rank: "Mythic",
                skins: 38,
                description: "T√†i kho·∫£n Mobile Legends rank Mythic, hero v√† skin premium",
                image: "‚öîÔ∏è",
                rating: 4.8,
                reviews: 92,
                username: "ml_mythic_legend",
                password: "ML2024&Mythic",
                sold: false
            }
        ];

        let cart = [];
        let currentUser = null;
        let orders = [];
        let users = [];
        let rechargeRequests = [];
        let totalRevenue = 0;
        let todayOrders = 0;

        // Initialize app
        function initApp() {
            if (!currentUser) {
                showPage('login-required');
            } else {
                showPage('home');
                loadFeaturedProducts();
            }
        }

        // Page navigation
        function showPage(pageId) {
            // Check login requirement
            if (!currentUser && !['login', 'register', 'login-required'].includes(pageId)) {
                showPage('login-required');
                return;
            }

            document.querySelectorAll('.page').forEach(page => {
                page.classList.add('hidden');
            });
            document.getElementById(pageId + '-page').classList.remove('hidden');
            document.getElementById(pageId + '-page').classList.add('fade-in');

            if (pageId === 'products') {
                loadProducts();
            } else if (pageId === 'home') {
                loadFeaturedProducts();
                updateUserBalance();
            } else if (pageId === 'cart') {
                loadCart();
            } else if (pageId === 'checkout') {
                loadCheckout();
            } else if (pageId === 'orders') {
                loadOrders();
            } else if (pageId === 'profile') {
                loadProfile();
            } else if (pageId === 'admin') {
                loadAdminProducts();
            }
        }

        // Load featured products
        function loadFeaturedProducts() {
            const container = document.getElementById('featured-products');
            container.innerHTML = products.slice(0, 4).map(product => `
                <div class="bg-white/10 backdrop-blur-md rounded-xl p-4 hover:bg-white/20 transition cursor-pointer" onclick="showProductDetail(${product.id})">
                    <div class="text-4xl mb-3 text-center">${product.image}</div>
                    <h4 class="font-semibold text-white mb-2">${product.name}</h4>
                    <p class="text-white/70 text-sm mb-2">${product.game}</p>
                    <div class="flex justify-between items-center">
                        <span class="text-yellow-400 font-bold">${formatPrice(product.price)}</span>
                        <div class="flex items-center text-yellow-400 text-sm">
                            ‚≠ê ${product.rating}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Load products
        function loadProducts() {
            const container = document.getElementById('products-grid');
            const gameFilter = document.getElementById('game-filter').value;
            const priceFilter = document.getElementById('price-filter').value;

            let filteredProducts = products;

            if (gameFilter) {
                filteredProducts = filteredProducts.filter(p => p.game === gameFilter);
            }

            if (priceFilter) {
                const [min, max] = priceFilter.split('-').map(Number);
                filteredProducts = filteredProducts.filter(p => p.price >= min && p.price <= max);
            }

            container.innerHTML = filteredProducts.map(product => `
                <div class="bg-white/10 backdrop-blur-md rounded-xl p-6 hover:bg-white/20 transition">
                    <div class="text-5xl mb-4 text-center">${product.image}</div>
                    <h3 class="text-xl font-semibold text-white mb-2">${product.name}</h3>
                    <p class="text-white/70 mb-2">${product.game}</p>
                    <div class="flex justify-between items-center mb-3">
                        <span class="text-sm text-white/60">Rank: ${product.rank}</span>
                        <span class="text-sm text-white/60">${product.skins} skins</span>
                    </div>
                    <div class="flex items-center mb-3">
                        <div class="flex text-yellow-400 text-sm mr-2">
                            ‚≠ê ${product.rating}
                        </div>
                        <span class="text-white/60 text-sm">(${product.reviews} ƒë√°nh gi√°)</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-2xl font-bold text-yellow-400">${formatPrice(product.price)}</span>
                        <div class="space-x-2">
                            <button onclick="showProductDetail(${product.id})" class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-white text-sm transition">
                                Chi ti·∫øt
                            </button>
                            <button onclick="addToCart(${product.id})" class="bg-green-600 hover:bg-green-700 px-3 py-1 rounded text-white text-sm transition">
                                Th√™m v√†o gi·ªè
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Show product detail
        function showProductDetail(productId) {
            const product = products.find(p => p.id === productId);
            const container = document.getElementById('product-detail-content');
            
            container.innerHTML = `
                <div class="grid md:grid-cols-2 gap-8">
                    <div class="bg-white/10 backdrop-blur-md rounded-xl p-8 text-center">
                        <div class="text-8xl mb-6">${product.image}</div>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="bg-white/10 rounded-lg p-3">
                                <div class="text-white/60">Game</div>
                                <div class="text-white font-semibold">${product.game}</div>
                            </div>
                            <div class="bg-white/10 rounded-lg p-3">
                                <div class="text-white/60">Rank</div>
                                <div class="text-white font-semibold">${product.rank}</div>
                            </div>
                            <div class="bg-white/10 rounded-lg p-3">
                                <div class="text-white/60">Skins</div>
                                <div class="text-white font-semibold">${product.skins}</div>
                            </div>
                            <div class="bg-white/10 rounded-lg p-3">
                                <div class="text-white/60">ƒê√°nh gi√°</div>
                                <div class="text-white font-semibold">‚≠ê ${product.rating}</div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white/10 backdrop-blur-md rounded-xl p-8">
                        <h1 class="text-3xl font-bold text-white mb-4">${product.name}</h1>
                        <p class="text-white/80 mb-6">${product.description}</p>
                        
                        <div class="mb-6">
                            <h3 class="text-xl font-semibold text-white mb-3">ƒê√°nh gi√° t·ª´ kh√°ch h√†ng</h3>
                            <div class="space-y-3">
                                <div class="bg-white/10 rounded-lg p-4">
                                    <div class="flex items-center mb-2">
                                        <span class="text-yellow-400">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                                        <span class="text-white/60 ml-2 text-sm">- Nguy·ªÖn VƒÉn A</span>
                                    </div>
                                    <p class="text-white/80 text-sm">T√†i kho·∫£n ch·∫•t l∆∞·ª£ng, giao h√†ng nhanh!</p>
                                </div>
                                <div class="bg-white/10 rounded-lg p-4">
                                    <div class="flex items-center mb-2">
                                        <span class="text-yellow-400">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                                        <span class="text-white/60 ml-2 text-sm">- Tr·∫ßn Th·ªã B</span>
                                    </div>
                                    <p class="text-white/80 text-sm">R·∫•t h√†i l√≤ng v·ªõi d·ªãch v·ª•, s·∫Ω mua l·∫°i!</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="border-t border-white/20 pt-6">
                            <div class="flex justify-between items-center mb-6">
                                <span class="text-3xl font-bold text-yellow-400">${formatPrice(product.price)}</span>
                                <div class="text-white/60">
                                    <span class="text-sm">${product.reviews} ƒë√°nh gi√°</span>
                                </div>
                            </div>
                            <div class="space-y-3">
                                <button onclick="addToCart(${product.id})" class="w-full bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 px-6 py-3 rounded-lg text-white font-semibold transition">
                                    Th√™m v√†o gi·ªè h√†ng
                                </button>
                                <button onclick="buyNow(${product.id})" class="w-full bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700 px-6 py-3 rounded-lg text-white font-semibold transition">
                                    Mua ngay
                                </button>
                                <button onclick="showPage('products')" class="w-full bg-gray-600 hover:bg-gray-700 px-6 py-3 rounded-lg text-white font-semibold transition">
                                    Quay l·∫°i danh s√°ch
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            showPage('product-detail');
        }

        // Add to cart
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({...product, quantity: 1});
            }
            
            updateCartCount();
            showNotification('ƒê√£ th√™m v√†o gi·ªè h√†ng!', 'success');
        }

        // Buy now
        function buyNow(productId) {
            addToCart(productId);
            showPage('checkout');
        }

        // Update cart count
        function updateCartCount() {
            const count = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cart-count').textContent = count;
            if (count > 0) {
                document.getElementById('cart-count').classList.add('cart-badge');
            }
        }

        // Load cart
        function loadCart() {
            const container = document.getElementById('cart-items');
            const totalElement = document.getElementById('cart-total');
            
            if (cart.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8">
                        <div class="text-6xl mb-4">üõí</div>
                        <p class="text-white/60 mb-4">Gi·ªè h√†ng c·ªßa b·∫°n ƒëang tr·ªëng</p>
                        <button onclick="showPage('products')" class="bg-blue-600 hover:bg-blue-700 px-6 py-2 rounded-lg text-white transition">
                            Ti·∫øp t·ª•c mua s·∫Øm
                        </button>
                    </div>
                `;
                totalElement.textContent = '0ƒë';
                return;
            }
            
            container.innerHTML = cart.map(item => `
                <div class="flex items-center justify-between py-4 border-b border-white/20">
                    <div class="flex items-center space-x-4">
                        <div class="text-3xl">${item.image}</div>
                        <div>
                            <h4 class="font-semibold text-white">${item.name}</h4>
                            <p class="text-white/60 text-sm">${item.game}</p>
                            <p class="text-yellow-400 font-semibold">${formatPrice(item.price)}</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-3">
                        <button onclick="updateCartQuantity(${item.id}, -1)" class="bg-red-600 hover:bg-red-700 w-8 h-8 rounded-full text-white transition">-</button>
                        <span class="text-white font-semibold w-8 text-center">${item.quantity}</span>
                        <button onclick="updateCartQuantity(${item.id}, 1)" class="bg-green-600 hover:bg-green-700 w-8 h-8 rounded-full text-white transition">+</button>
                        <button onclick="removeFromCart(${item.id})" class="bg-gray-600 hover:bg-gray-700 px-3 py-1 rounded text-white text-sm transition">X√≥a</button>
                    </div>
                </div>
            `).join('');
            
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            totalElement.textContent = formatPrice(total);
        }

        // Update cart quantity
        function updateCartQuantity(productId, change) {
            const item = cart.find(item => item.id === productId);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeFromCart(productId);
                } else {
                    updateCartCount();
                    loadCart();
                }
            }
        }

        // Remove from cart
        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCartCount();
            loadCart();
        }

        // Load checkout
        function loadCheckout() {
            const itemsContainer = document.getElementById('checkout-items');
            const totalElement = document.getElementById('checkout-total');
            const balanceElement = document.getElementById('checkout-balance');
            
            itemsContainer.innerHTML = cart.map(item => `
                <div class="flex justify-between items-center py-2 border-b border-white/20">
                    <div>
                        <span class="text-white">${item.name}</span>
                        <span class="text-white/60 text-sm ml-2">x${item.quantity}</span>
                    </div>
                    <span class="text-yellow-400">${formatPrice(item.price * item.quantity)}</span>
                </div>
            `).join('');
            
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            totalElement.textContent = formatPrice(total);
            balanceElement.textContent = formatPrice(currentUser.balance || 0);
        }

        // Load orders
        function loadOrders() {
            const container = document.getElementById('orders-list');
            
            if (orders.length === 0) {
                container.innerHTML = `
                    <div class="bg-white/10 backdrop-blur-md rounded-xl p-8 text-center">
                        <div class="text-6xl mb-4">üìã</div>
                        <p class="text-white/60 mb-4">B·∫°n ch∆∞a c√≥ ƒë∆°n h√†ng n√†o</p>
                        <button onclick="showPage('products')" class="bg-blue-600 hover:bg-blue-700 px-6 py-2 rounded-lg text-white transition">
                            Mua s·∫Øm ngay
                        </button>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = orders.map(order => `
                <div class="bg-white/10 backdrop-blur-md rounded-xl p-6">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="text-xl font-semibold text-white">ƒê∆°n h√†ng #${order.id}</h3>
                            <p class="text-white/60">${order.date}</p>
                        </div>
                        <span class="px-3 py-1 rounded-full text-sm ${order.status === 'completed' ? 'bg-green-600' : 'bg-yellow-600'} text-white">
                            ${order.status === 'completed' ? 'Ho√†n th√†nh' : 'ƒêang x·ª≠ l√Ω'}
                        </span>
                    </div>
                    <div class="space-y-2 mb-4">
                        ${order.items.map(item => `
                            <div class="flex justify-between text-white/80">
                                <span>${item.name} x${item.quantity}</span>
                                <span>${formatPrice(item.price * item.quantity)}</span>
                            </div>
                        `).join('')}
                    </div>
                    <div class="border-t border-white/20 pt-4 flex justify-between items-center">
                        <span class="text-white font-semibold">T·ªïng c·ªông: ${formatPrice(order.total)}</span>
                        <button onclick="showOrderDetail(${order.id})" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg text-white transition">
                            Xem chi ti·∫øt
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Load profile
        function loadProfile() {
            if (!currentUser) return;
            
            document.getElementById('profile-name').textContent = currentUser.name;
            document.getElementById('profile-email').textContent = currentUser.email;
            document.getElementById('profile-balance').textContent = formatPrice(currentUser.balance || 0);
            
            const userOrders = orders.filter(order => order.userId === currentUser.id);
            const totalSpent = userOrders.reduce((sum, order) => sum + order.total, 0);
            
            document.getElementById('profile-spent').textContent = formatPrice(totalSpent);
            document.getElementById('profile-orders').textContent = userOrders.length;
            
            const historyContainer = document.getElementById('profile-purchase-history');
            
            if (userOrders.length === 0) {
                historyContainer.innerHTML = `
                    <div class="text-center py-8">
                        <div class="text-4xl mb-4">üõçÔ∏è</div>
                        <p class="text-white/60 mb-4">Ch∆∞a c√≥ l·ªãch s·ª≠ mua h√†ng</p>
                        <button onclick="showPage('products')" class="bg-blue-600 hover:bg-blue-700 px-6 py-2 rounded-lg text-white transition">
                            Mua s·∫Øm ngay
                        </button>
                    </div>
                `;
                return;
            }
            
            historyContainer.innerHTML = userOrders.map(order => `
                <div class="bg-white/10 rounded-xl p-4 hover:bg-white/20 transition">
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <h4 class="font-semibold text-white">ƒê∆°n h√†ng #${order.id}</h4>
                            <p class="text-white/70 text-sm">${order.date}</p>
                        </div>
                        <div class="text-right">
                            <p class="text-yellow-400 font-semibold">${formatPrice(order.total)}</p>
                            <span class="px-2 py-1 rounded-full text-xs ${order.status === 'completed' ? 'bg-green-600' : 'bg-yellow-600'}">
                                ${order.status === 'completed' ? 'Ho√†n th√†nh' : 'Ch·ªù x·ª≠ l√Ω'}
                            </span>
                        </div>
                    </div>
                    <div class="space-y-2 mb-3">
                        ${order.items.map(item => `
                            <div class="flex justify-between text-white/80 text-sm">
                                <span>${item.name}</span>
                                <span>${formatPrice(item.price)}</span>
                            </div>
                        `).join('')}
                    </div>
                    ${order.status === 'completed' ? `
                        <button onclick="showOrderDetail(${order.id})" class="bg-green-600 hover:bg-green-700 px-3 py-1 rounded text-sm transition">
                            Xem th√¥ng tin t√†i kho·∫£n
                        </button>
                    ` : ''}
                </div>
            `).join('');
        }

        // Format price
        function formatPrice(price) {
            return new Intl.NumberFormat('vi-VN', {
                style: 'currency',
                currency: 'VND'
            }).format(price);
        }

        // Show order detail with account info
        function showOrderDetail(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order || order.status !== 'completed') return;
            
            const accountInfo = order.items.map(item => {
                const product = products.find(p => p.id === item.id);
                return `
                    <div class="bg-white/10 rounded-xl p-6 mb-4">
                        <div class="flex items-center mb-4">
                            <div class="text-4xl mr-4">${item.image}</div>
                            <div>
                                <h4 class="text-xl font-semibold text-white">${item.name}</h4>
                                <p class="text-white/70">${item.game}</p>
                            </div>
                        </div>
                        <div class="bg-green-600/20 border border-green-500/30 rounded-lg p-4">
                            <h5 class="text-green-400 font-semibold mb-3">üîë Th√¥ng tin t√†i kho·∫£n:</h5>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="text-white/60 text-sm">T√†i kho·∫£n:</label>
                                    <div class="bg-white/10 rounded px-3 py-2 mt-1">
                                        <span class="text-white font-mono">${product?.username || 'N/A'}</span>
                                        <button onclick="copyToClipboard('${product?.username || ''}')" class="ml-2 text-blue-400 hover:text-blue-300 text-sm">üìã</button>
                                    </div>
                                </div>
                                <div>
                                    <label class="text-white/60 text-sm">M·∫≠t kh·∫©u:</label>
                                    <div class="bg-white/10 rounded px-3 py-2 mt-1">
                                        <span class="text-white font-mono">${product?.password || 'N/A'}</span>
                                        <button onclick="copyToClipboard('${product?.password || ''}')" class="ml-2 text-blue-400 hover:text-blue-300 text-sm">üìã</button>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4 p-3 bg-yellow-600/20 border border-yellow-500/30 rounded">
                                <p class="text-yellow-400 text-sm">‚ö†Ô∏è L∆∞u √Ω: Vui l√≤ng ƒë·ªïi m·∫≠t kh·∫©u sau khi ƒëƒÉng nh·∫≠p l·∫ßn ƒë·∫ßu ƒë·ªÉ b·∫£o m·∫≠t t√†i kho·∫£n.</p>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            // Create modal
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white/10 backdrop-blur-md rounded-xl p-6 max-w-2xl mx-4 max-h-[90vh] overflow-y-auto">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-bold text-white">Chi ti·∫øt ƒë∆°n h√†ng #${order.id}</h3>
                        <button onclick="this.closest('.fixed').remove()" class="text-white/60 hover:text-white text-2xl">√ó</button>
                    </div>
                    <div class="mb-4">
                        <p class="text-white/70">Ng√†y mua: ${order.date}</p>
                        <p class="text-white/70">T·ªïng ti·ªÅn: <span class="text-yellow-400 font-semibold">${formatPrice(order.total)}</span></p>
                    </div>
                    ${accountInfo}
                    <div class="text-center">
                        <button onclick="this.closest('.fixed').remove()" class="bg-blue-600 hover:bg-blue-700 px-6 py-2 rounded-lg text-white transition">
                            ƒê√≥ng
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // Copy to clipboard function
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showNotification('ƒê√£ sao ch√©p v√†o clipboard!', 'success');
            }).catch(() => {
                showNotification('Kh√¥ng th·ªÉ sao ch√©p!', 'error');
            });
        }

        // Update user balance display
        function updateUserBalance() {
            if (currentUser) {
                document.getElementById('user-balance').textContent = formatPrice(currentUser.balance || 0);
            }
        }

        // Request recharge
        function requestRecharge() {
            // Update transfer content with current user name
            if (currentUser) {
                document.getElementById('transfer-content').textContent = currentUser.name;
            }
            document.getElementById('recharge-modal').classList.remove('hidden');
            document.getElementById('recharge-modal').classList.add('flex');
        }

        function closeRechargeModal() {
            document.getElementById('recharge-modal').classList.add('hidden');
            document.getElementById('recharge-modal').classList.remove('flex');
        }

        // Form handlers
        document.getElementById('login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const email = this.querySelector('input[type="email"]').value;
            const password = this.querySelector('input[type="password"]').value;
            
            // Show loading
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'ƒêang ƒëƒÉng nh·∫≠p...';
            submitBtn.disabled = true;
            
            // Simulate API call
            setTimeout(() => {
                // Demo login credentials
                if (email === 'admin@gameshop.com' && password === 'admin123') {
                    currentUser = { email, role: 'admin', name: 'Qu·∫£n tr·ªã vi√™n', id: 1, balance: 0 };
                    updateUserMenu();
                    showNotification('ƒêƒÉng nh·∫≠p admin th√†nh c√¥ng!', 'success');
                    showPage('admin');
                } else if (email && password) {
                    // Find existing user or create new one
                    let user = users.find(u => u.email === email);
                    if (!user) {
                        user = { email, role: 'user', name: 'Ng∆∞·ªùi d√πng', id: Date.now(), balance: 0 };
                        users.push(user);
                    }
                    currentUser = user;
                    updateUserMenu();
                    showNotification('ƒêƒÉng nh·∫≠p th√†nh c√¥ng!', 'success');
                    showPage('home');
                } else {
                    showNotification('Email ho·∫∑c m·∫≠t kh·∫©u kh√¥ng ƒë√∫ng!', 'error');
                }
                
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }, 1000);
        });

        document.getElementById('register-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = this.querySelector('input[type="text"]').value;
            const email = this.querySelector('input[type="email"]').value;
            
            const newUser = { email, role: 'user', name, id: Date.now(), balance: 0 };
            users.push(newUser);
            currentUser = newUser;
            updateUserMenu();
            showPage('home');
            showNotification('ƒêƒÉng k√Ω th√†nh c√¥ng!', 'success');
        });

        document.getElementById('checkout-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            if (currentUser.balance < total) {
                showNotification('S·ªë d∆∞ kh√¥ng ƒë·ªß! Vui l√≤ng n·∫°p th√™m ti·ªÅn.', 'error');
                return;
            }
            
            // Deduct balance
            currentUser.balance -= total;
            
            // Mark products as sold
            cart.forEach(cartItem => {
                const product = products.find(p => p.id === cartItem.id);
                if (product) {
                    product.sold = true;
                }
            });

            // Create order
            const order = {
                id: Date.now(),
                date: new Date().toLocaleDateString('vi-VN'),
                items: [...cart],
                total: total,
                status: 'completed',
                userId: currentUser.id
            };
            
            orders.push(order);
            cart = [];
            updateCartCount();
            updateUserBalance();
            
            // Update admin stats
            totalRevenue += total;
            todayOrders += 1;
            updateAdminStats();
            
            showNotification('Thanh to√°n th√†nh c√¥ng!', 'success');
            showPage('orders');
        });

        document.getElementById('recharge-request-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const amount = parseInt(this.querySelector('input[type="number"]').value);
            const note = this.querySelector('textarea').value;
            
            const request = {
                id: Date.now(),
                userId: currentUser.id,
                userEmail: currentUser.email,
                userName: currentUser.name,
                amount: amount,
                note: note,
                status: 'pending',
                date: new Date().toLocaleDateString('vi-VN')
            };
            
            rechargeRequests.push(request);
            closeRechargeModal();
            showNotification('Y√™u c·∫ßu n·∫°p ti·ªÅn ƒë√£ ƒë∆∞·ª£c g·ª≠i!', 'success');
            
            // Update admin recharge requests display
            loadRechargeRequests();
        });

        // Update user menu
        function updateUserMenu() {
            const userMenu = document.getElementById('user-menu');
            const adminNav = document.getElementById('admin-nav');
            const mainNav = document.getElementById('main-nav');
            const cartBtn = document.getElementById('cart-btn');
            
            if (currentUser) {
                userMenu.innerHTML = `
                    <span class="text-white">Xin ch√†o, ${currentUser.name}</span>
                    <button onclick="logout()" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded-lg text-white transition">ƒêƒÉng xu·∫•t</button>
                `;
                
                mainNav.style.display = 'flex';
                cartBtn.style.display = 'block';
                
                // Show/hide Telegram icon based on user role
                const telegramIcon = document.getElementById('telegram-icon');
                if (currentUser.role === 'admin') {
                    adminNav.classList.remove('hidden');
                    telegramIcon.style.display = 'none';
                } else {
                    adminNav.classList.add('hidden');
                    telegramIcon.style.display = 'block';
                }
            } else {
                userMenu.innerHTML = `
                    <button onclick="showPage('login')" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg text-white transition">ƒêƒÉng nh·∫≠p</button>
                    <button onclick="showPage('register')" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg text-white transition">ƒêƒÉng k√Ω</button>
                `;
                adminNav.classList.add('hidden');
                mainNav.style.display = 'none';
                cartBtn.style.display = 'none';
                document.getElementById('telegram-icon').style.display = 'none';
            }
        }

        // Logout
        function logout() {
            currentUser = null;
            cart = [];
            updateUserMenu();
            updateCartCount();
            showPage('login-required');
            showNotification('ƒê√£ ƒëƒÉng xu·∫•t!', 'success');
        }

        // Filter handlers
        document.getElementById('game-filter').addEventListener('change', loadProducts);
        document.getElementById('price-filter').addEventListener('change', loadProducts);

        // Notification system
        function showNotification(message, type = 'info') {
            const container = document.getElementById('notification-container');
            const notification = document.createElement('div');
            
            const colors = {
                success: 'bg-green-600',
                error: 'bg-red-600',
                warning: 'bg-yellow-600',
                info: 'bg-blue-600'
            };
            
            notification.className = `notification ${colors[type]} text-white px-6 py-4 rounded-lg shadow-lg max-w-sm`;
            notification.innerHTML = `
                <div class="flex items-center justify-between">
                    <span>${message}</span>
                    <button onclick="this.parentElement.parentElement.classList.add('hide')" class="ml-4 text-white/80 hover:text-white">‚úï</button>
                </div>
            `;
            
            container.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('hide');
                setTimeout(() => {
                    if (notification.parentElement) {
                        notification.parentElement.removeChild(notification);
                    }
                }, 300);
            }, 4000);
        }

        // Loading overlay
        function showLoading() {
            document.getElementById('loading-overlay').classList.remove('hidden');
            document.getElementById('loading-overlay').classList.add('flex');
        }

        function hideLoading() {
            document.getElementById('loading-overlay').classList.add('hidden');
            document.getElementById('loading-overlay').classList.remove('flex');
        }

        // Admin functions
        function showAdminTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.remove('active', 'border-blue-500', 'text-white');
                tab.classList.add('text-white/70', 'border-transparent');
            });
            
            event.target.classList.add('active', 'border-blue-500', 'text-white');
            event.target.classList.remove('text-white/70', 'border-transparent');
            
            // Update tab content
            document.querySelectorAll('.admin-tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            document.getElementById(`admin-${tabName}`).classList.remove('hidden');
            
            // Load data for specific tab
            if (tabName === 'products') {
                loadAdminProducts();
            } else if (tabName === 'orders') {
                loadAdminOrders();
            } else if (tabName === 'users') {
                loadAdminUsers();
            } else if (tabName === 'recharge') {
                loadRechargeRequests();
            }
        }

        function loadAdminProducts() {
            const tbody = document.getElementById('admin-products-table');
            tbody.innerHTML = products.map(product => `
                <tr class="border-b border-white/10 hover:bg-white/5">
                    <td class="px-4 py-3">#${product.id}</td>
                    <td class="px-4 py-3">${product.name}</td>
                    <td class="px-4 py-3">${product.game}</td>
                    <td class="px-4 py-3">${formatPrice(product.price)}</td>
                    <td class="px-4 py-3">
                        <span class="px-2 py-1 bg-green-600 rounded-full text-xs">C√≤n h√†ng</span>
                    </td>
                    <td class="px-4 py-3">
                        <div class="flex space-x-2">
                            <button onclick="editProduct(${product.id})" class="bg-blue-600 hover:bg-blue-700 px-2 py-1 rounded text-xs transition">
                                S·ª≠a
                            </button>
                            <button onclick="deleteProduct(${product.id})" class="bg-red-600 hover:bg-red-700 px-2 py-1 rounded text-xs transition">
                                X√≥a
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
            
            // Update remaining accounts stat
            document.getElementById('remaining-accounts').textContent = products.length;
        }

        function loadAdminOrders() {
            const container = document.getElementById('admin-orders-list');
            
            if (orders.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-white/60 py-8">
                        Ch∆∞a c√≥ ƒë∆°n h√†ng n√†o
                    </div>
                `;
                return;
            }
            
            container.innerHTML = orders.map(order => `
                <div class="bg-white/10 rounded-xl p-4 hover:bg-white/20 transition">
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <h4 class="font-semibold text-white">ƒê∆°n h√†ng #${order.id}</h4>
                            <p class="text-white/70 text-sm">Ng√†y: ${order.date}</p>
                        </div>
                        <div class="text-right">
                            <p class="text-yellow-400 font-semibold">${formatPrice(order.total)}</p>
                            <span class="px-2 py-1 rounded-full text-xs ${order.status === 'completed' ? 'bg-green-600' : 'bg-yellow-600'}">
                                ${order.status === 'completed' ? 'Ho√†n th√†nh' : 'Ch·ªù x·ª≠ l√Ω'}
                            </span>
                        </div>
                    </div>
                    <div class="flex space-x-2">
                        <button class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm transition">
                            Xem chi ti·∫øt
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function loadAdminUsers() {
            const container = document.getElementById('admin-users-list');
            
            if (users.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-white/60 py-8">
                        Ch∆∞a c√≥ ng∆∞·ªùi d√πng n√†o
                    </div>
                `;
                return;
            }
            
            container.innerHTML = users.map(user => `
                <div class="bg-white/10 rounded-xl p-4 hover:bg-white/20 transition">
                    <div class="flex justify-between items-start">
                        <div>
                            <h4 class="font-semibold text-white">${user.name}</h4>
                            <p class="text-white/70 text-sm">${user.email}</p>
                            <p class="text-white/70 text-sm">S·ªë d∆∞: ${formatPrice(user.balance || 0)}</p>
                        </div>
                        <div class="text-right">
                            <p class="text-white font-semibold">${user.role}</p>
                        </div>
                    </div>
                </div>
            `).join('');
            
            // Update total users stat
            document.getElementById('total-users').textContent = users.length;
        }

        function loadRechargeRequests() {
            const container = document.getElementById('recharge-requests');
            
            if (rechargeRequests.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-white/60 py-8">
                        Ch∆∞a c√≥ y√™u c·∫ßu n·∫°p ti·ªÅn n√†o
                    </div>
                `;
                return;
            }
            
            container.innerHTML = rechargeRequests.map(request => `
                <div class="bg-white/10 rounded-xl p-4 hover:bg-white/20 transition">
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <h4 class="font-semibold text-white">${request.userName}</h4>
                            <p class="text-white/70 text-sm">${request.userEmail}</p>
                            <p class="text-white/70 text-sm">Ng√†y: ${request.date}</p>
                            ${request.note ? `<p class="text-white/70 text-sm">Ghi ch√∫: ${request.note}</p>` : ''}
                        </div>
                        <div class="text-right">
                            <p class="text-yellow-400 font-semibold">${formatPrice(request.amount)}</p>
                            <span class="px-2 py-1 rounded-full text-xs ${request.status === 'completed' ? 'bg-green-600' : 'bg-yellow-600'}">
                                ${request.status === 'completed' ? 'ƒê√£ x·ª≠ l√Ω' : 'Ch·ªù x·ª≠ l√Ω'}
                            </span>
                        </div>
                    </div>
                    ${request.status === 'pending' ? `
                        <div class="flex space-x-2">
                            <button onclick="approveRecharge(${request.id})" class="bg-green-600 hover:bg-green-700 px-3 py-1 rounded text-sm transition">
                                Duy·ªát
                            </button>
                            <button onclick="rejectRecharge(${request.id})" class="bg-red-600 hover:bg-red-700 px-3 py-1 rounded text-sm transition">
                                T·ª´ ch·ªëi
                            </button>
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        function approveRecharge(requestId) {
            const request = rechargeRequests.find(r => r.id === requestId);
            if (request) {
                const user = users.find(u => u.email === request.userEmail);
                if (user) {
                    user.balance = (user.balance || 0) + request.amount;
                    request.status = 'completed';
                    
                    // Update current user balance if it's the same user
                    if (currentUser && currentUser.email === user.email) {
                        currentUser.balance = user.balance;
                        updateUserBalance();
                    }
                    
                    loadRechargeRequests();
                    showNotification(`ƒê√£ n·∫°p ${formatPrice(request.amount)} cho ${user.name}`, 'success');
                }
            }
        }

        function rejectRecharge(requestId) {
            const index = rechargeRequests.findIndex(r => r.id === requestId);
            if (index !== -1) {
                rechargeRequests.splice(index, 1);
                loadRechargeRequests();
                showNotification('ƒê√£ t·ª´ ch·ªëi y√™u c·∫ßu n·∫°p ti·ªÅn', 'warning');
            }
        }

        // Admin recharge form
        document.getElementById('recharge-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const email = document.getElementById('recharge-email').value;
            const amount = parseInt(document.getElementById('recharge-amount').value);
            
            const user = users.find(u => u.email === email);
            if (user) {
                user.balance = (user.balance || 0) + amount;
                
                // Update current user balance if it's the same user
                if (currentUser && currentUser.email === user.email) {
                    currentUser.balance = user.balance;
                    updateUserBalance();
                }
                
                this.reset();
                showNotification(`ƒê√£ n·∫°p ${formatPrice(amount)} cho ${user.name}`, 'success');
            } else {
                showNotification('Kh√¥ng t√¨m th·∫•y ng∆∞·ªùi d√πng v·ªõi email n√†y!', 'error');
            }
        });

        function updateAdminStats() {
            document.getElementById('total-revenue').textContent = formatPrice(totalRevenue);
            document.getElementById('today-orders').textContent = todayOrders;
        }

        function refreshAdminData() {
            showLoading();
            setTimeout(() => {
                loadAdminProducts();
                loadAdminOrders();
                loadAdminUsers();
                loadRechargeRequests();
                updateAdminStats();
                hideLoading();
                showNotification('D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t!', 'success');
            }, 1500);
        }

        function showAddProductModal() {
            document.getElementById('product-modal-title').textContent = 'Th√™m s·∫£n ph·∫©m m·ªõi';
            document.getElementById('product-form').reset();
            document.getElementById('product-id').value = '';
            document.getElementById('product-modal').classList.remove('hidden');
            document.getElementById('product-modal').classList.add('flex');
        }

        function closeProductModal() {
            document.getElementById('product-modal').classList.add('hidden');
            document.getElementById('product-modal').classList.remove('flex');
        }

        function importCSV() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.csv';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    showNotification(`ƒêang import file ${file.name}...`, 'info');
                    // Simulate import process
                    setTimeout(() => {
                        showNotification('Import th√†nh c√¥ng 10 s·∫£n ph·∫©m m·ªõi!', 'success');
                        loadAdminProducts();
                    }, 2000);
                }
            };
            input.click();
        }

        function editProduct(id) {
            const product = products.find(p => p.id === id);
            if (product) {
                document.getElementById('product-modal-title').textContent = 'Ch·ªânh s·ª≠a s·∫£n ph·∫©m';
                document.getElementById('product-id').value = product.id;
                document.getElementById('product-name').value = product.name;
                document.getElementById('product-game').value = product.game;
                document.getElementById('product-price').value = product.price;
                document.getElementById('product-rank').value = product.rank;
                document.getElementById('product-skins').value = product.skins;
                document.getElementById('product-description').value = product.description;
                document.getElementById('product-image').value = product.image;
                document.getElementById('product-username').value = product.username;
                document.getElementById('product-password').value = product.password;
                
                document.getElementById('product-modal').classList.remove('hidden');
                document.getElementById('product-modal').classList.add('flex');
            }
        }

        function deleteProduct(id) {
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a s·∫£n ph·∫©m n√†y?')) {
                const index = products.findIndex(p => p.id === id);
                if (index !== -1) {
                    products.splice(index, 1);
                    loadAdminProducts();
                    loadFeaturedProducts();
                    loadProducts();
                    showNotification(`ƒê√£ x√≥a s·∫£n ph·∫©m #${id}`, 'success');
                }
            }
        }

        // Product form handler
        document.getElementById('product-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const productData = {
                name: document.getElementById('product-name').value,
                game: document.getElementById('product-game').value,
                price: parseInt(document.getElementById('product-price').value),
                rank: document.getElementById('product-rank').value,
                skins: parseInt(document.getElementById('product-skins').value),
                description: document.getElementById('product-description').value,
                image: document.getElementById('product-image').value,
                username: document.getElementById('product-username').value,
                password: document.getElementById('product-password').value,
                rating: 4.5 + Math.random() * 0.5,
                reviews: Math.floor(Math.random() * 200) + 50,
                sold: false
            };
            
            const productId = document.getElementById('product-id').value;
            
            if (productId) {
                // Edit existing product
                const index = products.findIndex(p => p.id == productId);
                if (index !== -1) {
                    products[index] = { ...products[index], ...productData };
                    showNotification('C·∫≠p nh·∫≠t s·∫£n ph·∫©m th√†nh c√¥ng!', 'success');
                }
            } else {
                // Add new product
                const newProduct = {
                    id: Date.now(),
                    ...productData
                };
                products.push(newProduct);
                showNotification('Th√™m s·∫£n ph·∫©m m·ªõi th√†nh c√¥ng!', 'success');
            }
            
            closeProductModal();
            loadAdminProducts();
            loadFeaturedProducts();
            loadProducts();
        });

        // Initialize
        initApp();
        updateCartCount();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'985c63c092dcdd61',t:'MTc1ODk5MDY2OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
